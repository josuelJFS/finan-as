<!-- Use this file to provide workspace-specific custom instructions to Copilot. For more details, visit https://c2. **Implementar componentes**:
   - ‚úÖ MoneyInput para valores
   - ‚úÖ DatePicker para datas
   - ‚úÖ CategorySelector
   - ‚úÖ AccountSelector

3. **Funcionalidade core**:
   - ‚úÖ Pull-to-refresh em listas
   - ‚úÖ Atualiza√ß√£o autom√°tica quando volta para a tela
   - ‚ùå Criar transa√ß√£o com atualiza√ß√£o de saldo
   - ‚ùå C√°lculo de saldos em tempo real
   - ‚ùå Filtros funcionaisstudio.com/docs/copilot/copilot-customization#_use-a-githubcopilotinstructionsmd-file -->

# AppFinan√ßa - Personal Finance App

## MANIFESTO DE DESIGN & UX (Adicionar em toda nova feature)

Objetivo: cada tela deve ser clara em 5s, execut√°vel em at√© 3 toques para a a√ß√£o principal e consistente em todos os estados (loading, vazio, erro, sucesso).

Princ√≠pios obrigat√≥rios:

- Consist√™ncia visual: seguir tipografia, espa√ßamentos (m√∫ltiplos de 4 ‚Äî preferir 4/8/12/16/24), cores e padr√µes j√° definidos.
- Hierarquia clara: 1 a√ß√£o prim√°ria por tela (bot√£o destacado), secund√°rias em menor √™nfase, destrutivas em vermelho.
- Feedback imediato: toda a√ß√£o que leva >150ms deve ter indicador (spinner, skeleton, shimmer) e estado desabilitado claro.
- Estados completos: implementar para cada lista/form: loading, vazio (mensagem + CTA), erro (retry), conte√∫do.
- Acessibilidade: toques m√≠nimos 44x44dp, contraste AA, labels descritivos, √≠cones n√£o sem√¢nticos sempre com texto.
- Dark mode: paridade funcional e contraste revisado (n√£o usar puro #000 em superf√≠cies elevadas; usar tons neutros da paleta).
- Microintera√ß√µes leves: evitar anima√ß√µes longas (>300ms); transi√ß√µes suaves em modais e feedback de toque.
- Redu√ß√£o de fric√ß√£o: inputs pr√©-preenchidos quando poss√≠vel (datas, contas padr√£o, √∫ltimo filtro usado).
- Previsibilidade: nada ‚Äúpula‚Äù ap√≥s load tardio; reservar espa√ßo (layout shift zero) usando skeletons.

Checklist r√°pido antes de finalizar uma tela/componente:

1. Loading vis√≠vel e n√£o bloqueante? (Skeleton > Spinner isolado quando houver estrutura previs√≠vel)
2. Estado vazio educativo com CTA direto?
3. Erro recuper√°vel com bot√£o Tentar Novamente?
4. A√ß√£o principal claramente destacada?
5. Campos alinhados e espa√ßamentos consistentes (grid de 4)?
6. Toque confort√°vel (‚â•44dp) e texto leg√≠vel (‚â•14sp)?
7. Dark mode revisado manualmente?
8. Sem over-scroll branco/flash em dark? (usar cores de fundo corretas)
9. Logs de debug removidos ou reduzidos a warnings essenciais?
10. Performance: listas virtualizadas e sem renders desnecess√°rios (memo/useCallback onde faz sentido)?

Padr√µes visuais resumidos:

- Espa√ßamento vertical entre blocos: 16
- Espa√ßamento interno de cart√µes: 16
- Gap entre inputs consecutivos: 12
- Raio padr√£o: 8 (bot√µes, cart√µes) / 12 (modais top-sheet)
- √çcones: 20 (inline), 24 (bot√£o), 32‚Äì40 (avatar/c√≠rculo)

Evitar:

- Texto cinza claro demais em dark (#6b7280 ok; evitar < #4b5563 em body).
- Excesso de cores na mesma tela (m√°x 1 prim√°ria + estados sem√¢nticos).
- Placeholder como label (usar label sempre que input persistir valor).

Sempre que criar/alterar componente, validar com este manifesto antes do commit.

## ESPECIFICA√á√ïES COMPLETAS DO PROJETO

Aplicativo de finan√ßas pessoais, offline-first, usando Expo (React Native + TypeScript) com NativeWind para UI e SQLite para armazenamento local. O app deve ser r√°pido, acess√≠vel, f√°cil de usar, com foco em registrar despesas/receitas, or√ßamentos e relat√≥rios.

## STACK E PADR√ïES

- ‚úÖ Expo SDK (√∫ltima vers√£o est√°vel), TypeScript estrito, ESLint + Prettier
- ‚úÖ Navega√ß√£o: expo-router (tabs + stacks)
- ‚úÖ UI: NativeWind (TailwindCSS) com tema claro/escuro; componentes acess√≠veis
- ‚úÖ Estado: estado local por tela + Zustand para prefer√™ncias/tema/filtros
- ‚úÖ Banco: expo-sqlite com migrations versionadas e camada de acesso a dados (DAO)
- ‚úÖ Seguran√ßa: expo-secure-store para dados sens√≠veis, opcional biometria (expo-local-authentication)
- ‚úÖ Arquitetura: feature-first (features/transactions, features/budgets, etc.)
- ‚ö†Ô∏è Testes: unit√°rios (Vitest/Jest) para utils/DAOs; e2e opcional
- ‚ö†Ô∏è i18n: pt-BR por padr√£o, pronto para multi-idioma
- ‚ö†Ô∏è Performance: listas virtualizadas, memoiza√ß√£o, √≠ndices no SQLite

## FUNCIONALIDADES OBRIGAT√ìRIAS

1. ‚ö†Ô∏è **Onboarding**: simples com moeda padr√£o, conta inicial e tema (B√ÅSICO IMPLEMENTADO)
2. ‚úÖ **CRUD de contas**: saldo inicial, tipos diferentes e saldo total (CONCLU√çDO + PULL-TO-REFRESH)
3. ‚úÖ **CRUD de categorias**: hier√°rquicas (despesa/receita) (CONCLU√çDO + PULL-TO-REFRESH)
4. ‚úÖ **CRUD de transa√ß√µes**: tipo, conta, valor, data/hora, categoria, notas, tags, anexos (CONCLU√çDO)
5. ‚ö†Ô∏è **Busca e filtros**: com op√ß√£o de salvar filtros (B√ÅSICO IMPLEMENTADO)
6. ‚úÖ **Or√ßamentos**: CRUD completo (criar, editar, excluir) + progresso b√°sico e alerta visual (refinar c√°lculo e alertas globais pendente)
7. ‚ùå **Metas**: c√°lculo de progresso (N√ÉO IMPLEMENTADO)
8. ‚ùå **Transa√ß√µes recorrentes**: regras e materializa√ß√£o autom√°tica (N√ÉO IMPLEMENTADO)
9. ‚ö†Ô∏è **Dashboard**: saldo total, entradas/sa√≠das, gr√°ficos (B√ÅSICO IMPLEMENTADO)
10. ‚ùå **Anexos**: fotos de comprovantes com visualiza√ß√£o (N√ÉO IMPLEMENTADO)
11. ‚ùå **Backup/restore**: JSON/CSV com valida√ß√£o de schema (N√ÉO IMPLEMENTADO)

## MODELAGEM DE DADOS (SQLite)

‚úÖ **Tabelas implementadas**: settings, accounts, categories, transactions, budgets, goals, recurrences

- ‚úÖ **settings**: moeda, tema, datas
- ‚úÖ **accounts**: nome, tipo, saldo inicial, arquivada
- ‚úÖ **categories**: nome, pai, tipo
- ‚úÖ **transactions**: tipo, conta, conta destino, categoria, valor, data, nota, tags, anexo, recorr√™ncia
- ‚úÖ **budgets**: categoria, per√≠odo, valor
- ‚úÖ **goals**: nome, valor alvo, data limite, valor alocado
- ‚úÖ **recurrences**: template de transa√ß√£o, frequ√™ncia, pr√≥xima execu√ß√£o
- ‚ùå **√çndices**: em occurred_at e category_id (FALTANDO)

## TELAS E NAVEGA√á√ÉO

‚úÖ **Tabs**: Dashboard, Transa√ß√µes, Or√ßamentos, Configura√ß√µes
‚ùå **Stacks faltando**:

- Transa√ß√µes (detalhe, criar/editar)
- Or√ßamentos (criar/editar)
- Categorias (lista, criar/editar)
- Contas (lista, criar/editar)
- Recorr√™ncias (lista, criar/editar)
- Importar/Exportar

## FLUXOS CR√çTICOS PENDENTES

‚ùå **Criar transa√ß√£o**: atualiza√ß√£o de saldo at√¥mica
‚ùå **Filtros salvos**: totais recalculados
‚ùå **Materializar recorr√™ncias**: na abertura do app
‚ö†Ô∏è **Calcular progresso**: de or√ßamentos (otimiza√ß√£o e cache incremental)
‚ùå **Exportar CSV**: do per√≠odo atual
‚ùå **Alertas de or√ßamento**: surfaced no dashboard

## COMPONENTES REUTILIZ√ÅVEIS

‚úÖ **MoneyInput**: input para valores monet√°rios  
‚úÖ **DatePicker**: seletor de data  
‚úÖ **CategorySelector**: modal bottom-sheet com scroll fixo  
‚úÖ **AccountSelector**: modal bottom-sheet com scroll fixo  
‚ùå **CategoryPill**: chip de categoria

### üé® PADR√ÉO DE BOT√ïES EM FORMUL√ÅRIOS (OBRIGAT√ìRIO)

Para formul√°rios de criar/editar, SEMPRE usar bot√µes dentro do ScrollView com espa√ßamento seguro:

**Estrutura obrigat√≥ria:**

```tsx
import { SafeAreaView, useSafeAreaInsets } from "react-native-safe-area-context";

const insets = useSafeAreaInsets();
const bottomPadding = insets.bottom + 24; // espa√ßo para bot√µes dentro do scroll

return (
  <SafeAreaView className="flex-1 bg-gray-50 dark:bg-gray-900">
    <ScrollView
      className="flex-1"
      contentContainerStyle={{ padding: 16, paddingBottom: bottomPadding }}
      keyboardShouldPersistTaps="handled"
    >
      <View>
        {/* Conte√∫do do formul√°rio */}

        {/* Bot√µes dentro do scroll */}
        <View className="mt-2 flex-row gap-3 border-t border-gray-200 pt-3 dark:border-gray-700">
          <TouchableOpacity
            onPress={handleCancel}
            className="flex-1 rounded-md bg-gray-200 py-3 dark:bg-gray-700"
          >
            <Text className="text-center font-semibold text-gray-900 dark:text-white">
              Cancelar
            </Text>
          </TouchableOpacity>
          <TouchableOpacity
            onPress={handleSave}
            disabled={loading}
            className={`flex-1 rounded-md py-3 ${
              loading ? "bg-gray-300 dark:bg-gray-600" : "bg-blue-500"
            }`}
          >
            <Text className="text-center font-semibold text-white">
              {loading ? "Salvando..." : isEditing ? "Atualizar" : "Criar"}
            </Text>
          </TouchableOpacity>
        </View>
      </View>
    </ScrollView>
  </SafeAreaView>
);
```

**Pontos cr√≠ticos:**

- `paddingBottom: insets.bottom + 24` no ScrollView para espa√ßo dos bot√µes
- Bot√µes DENTRO do ScrollView (rolam junto com o conte√∫do)
- `border-t` + `pt-3` para separar visualmente dos campos
- `py-3` nos bot√µes para √°rea de toque adequada
- `keyboardShouldPersistTaps="handled"` para funcionamento do teclado
- Bot√µes sempre clic√°veis acima da navigation bar do sistema

**Aplicar em:** TransactionForm ‚úÖ, AccountForm, CategoryForm, BudgetForm, GoalForm

## DESENVOLVIMENTO ATUAL

### ‚úÖ CONCLU√çDO (Passo 0-4)

- Setup do projeto com Expo + TypeScript
- Configura√ß√£o do NativeWind
- Infra de banco com migrations e DAOs
- Navega√ß√£o e layout base (tabs)
- Telas b√°sicas com className
- CRUD de contas completo (UI + l√≥gica) ‚úÖ BUG CORRIGIDO
- CRUD de categorias completo (UI + l√≥gica hier√°rquica)
- CRUD de transa√ß√µes completo (receitas, despesas, transfer√™ncias)
- Componentes reutiliz√°veis: MoneyInput, DatePicker, AccountSelector, CategorySelector
- Padr√£o de bot√µes em formul√°rios documentado e implementado

### ‚ö†Ô∏è EM PROGRESSO (Passo 5)

- L√≥gica de saldos em tempo real
- Dashboard com gr√°ficos e KPIs (vers√£o inicial)
- Otimiza√ß√£o de c√°lculo de progresso de or√ßamentos

### ‚ùå PENDENTE (Passo 5-9)

- Dashboard avan√ßado (drilldown, comparativos)
- Filtros salvos e busca avan√ßada
- Alertas de or√ßamento consolidados (dashboard + badges)
- Transa√ß√µes recorrentes
- Anexos de comprovantes
- Backup e restore

## PRIORIDADES IMEDIATAS

1. **‚úÖ CORRIGIDO - Bug AccountForm**:
   - ‚úÖ AccountFormScreen: corrigido erro NOT NULL constraint failed: accounts.icon
   - ‚úÖ Fun√ß√£o getIconForType() implementada para garantir √≠cone baseado no tipo
   - ‚úÖ Dados de cria√ß√£o/atualiza√ß√£o sempre com √≠cone v√°lido

2. **CRUDs**:

- ‚úÖ Contas
- ‚úÖ Categorias
- ‚úÖ Transa√ß√µes
- ‚úÖ Or√ßamentos
- ‚ùå Dashboard com gr√°ficos e estat√≠sticas

3. **Implementar componentes**:
   - ‚úÖ MoneyInput para valores
   - ‚úÖ DatePicker para datas
   - ‚úÖ CategorySelector
   - ‚úÖ AccountSelector

4. **Funcionalidade core (pr√≥ximo)**:

- Atualiza√ß√£o de saldo em criar/editar/excluir transa√ß√µes
- Recalcular saldos globais incrementalmente
- Filtros funcionais b√°sicos (conta, tipo, per√≠odo)
- Otimizar c√°lculo de progresso de or√ßamentos e alertas

## GUIDELINES DE DESENVOLVIMENTO

- **SEMPRE usar className do NativeWind** ao inv√©s de StyleSheet
- **TypeScript strict mode** - todos os tipos definidos
- **Atomic operations** - transa√ß√µes de banco sempre em transaction
- **Feature-first structure** - organiza√ß√£o por funcionalidade
- **Acessibilidade** - todos os componentes com labels adequados
- **Performance** - usar React.memo, useCallback quando necess√°rio
- **UX Consistente** - aplicar o Manifesto de Design & UX: estados (loading/vazio/erro), a√ß√£o prim√°ria clara, spacing padronizado, dark mode testado
- **Feedback Imediato** - qualquer opera√ß√£o ass√≠ncrona >150ms deve sinalizar progresso
- **Estados Vazios Educativos** - sempre incluir mensagem + CTA para criar conte√∫do

## ESTRUTURA DE ARQUIVOS ATUAL

```
src/
‚îú‚îÄ‚îÄ components/        # Componentes reutiliz√°veis (VAZIO - IMPLEMENTAR)
‚îú‚îÄ‚îÄ features/         # Features por m√≥dulo
‚îÇ   ‚îú‚îÄ‚îÄ accounts/     # (IMPLEMENTAR UIs)
‚îÇ   ‚îú‚îÄ‚îÄ transactions/ # (IMPLEMENTAR UIs)
‚îÇ   ‚îú‚îÄ‚îÄ budgets/      # (IMPLEMENTAR UIs)
‚îÇ   ‚îî‚îÄ‚îÄ categories/   # (IMPLEMENTAR UIs)
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ database/     # ‚úÖ DAOs e migrations
‚îÇ   ‚îú‚îÄ‚îÄ store.ts      # ‚úÖ Zustand store
‚îÇ   ‚îî‚îÄ‚îÄ utils.ts      # ‚úÖ Fun√ß√µes utilit√°rias
‚îî‚îÄ‚îÄ types/
    ‚îî‚îÄ‚îÄ entities.ts   # ‚úÖ Tipos das entidades
```

## PR√ìXIMOS PASSOS CR√çTICOS (Atualizado)

1. L√≥gica de saldos em tempo real (opera√ß√µes at√¥micas)
2. Dashboard: KPIs + gr√°fico entradas vs sa√≠das
3. Progresso de or√ßamentos otimizado + alertas no dashboard
4. Filtros b√°sicos persistentes (conta, categoria, tipo, per√≠odo)
5. Exporta√ß√£o CSV (per√≠odo atual)
6. Motor de recorr√™ncias (materializa√ß√£o idempotente)
7. Backup/Restore JSON
8. Suporte a anexos (estrutura de arquivo + preview)

## DESIGN E UX

- **Paleta neutra** com tons de cinza e azul
- **Bot√µes grandes** para facilitar toque
- **Feedback t√°til** em a√ß√µes importantes
- **Skeletons** durante carregamento
- **Estados vazios educativos** com calls-to-action
- **Tema claro/escuro** autom√°tico baseado no sistema
